{"schemaVersion":{"minor":3,"major":0,"patch":0},"sections":[],"identifier":{"url":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Navigation-Article","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/KeyboardKit\/documentation\/KeyboardKit"]]},"seeAlsoSections":[{"title":"Features","generated":true,"identifiers":["doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Actions-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/AI-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Autocomplete-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Buttons-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Callouts-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Colors-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Device-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Emojis-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Extensions-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/External-Keyboards-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Feedback-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Gestures-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Images-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Layout-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Localization-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Previews-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Proxy-Utilities-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Settings-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/State-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Styling-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Text-Routing-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Themes-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Views"]}],"primaryContentSections":[{"content":[{"level":2,"type":"heading","anchor":"overview","text":"Overview"},{"inlineContent":[{"text":"Keyboard extensions may sometimes have to open a URL or trigger a deep link, for instance to open the main app or System Settings.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Keyboard extensions can however not access ","type":"text"},{"type":"strong","inlineContent":[{"text":"UIApplication.shared","type":"text"}]},{"type":"text","text":", which means that you have to jump through hoops to open URLs."}]},{"type":"paragraph","inlineContent":[{"text":"KeyboardKit therefore provides alternate ways to open URLs from a keyboard extension, without using ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"UIApplication.shared"}]},{"type":"text","text":"."}]},{"level":2,"text":"How to open URLs from a keyboard extension","anchor":"How-to-open-URLs-from-a-keyboard-extension","type":"heading"},{"inlineContent":[{"type":"text","text":"One way to open a URL from a keyboard extension, is to use the "},{"isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/openUrl(_:)","type":"reference"},{"type":"text","text":", which opens the provided URL without using the application."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you don’t want to depend on the controller (which can cause leaks), a better way is to trigger a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction\/url(_:id:)"},{"type":"text","text":" action and let the "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/services","isActive":true},{"type":"text","text":" action handler handle it."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction","type":"reference"},{"text":" approach removes any need to refer to the controller and lets you customize the URL handling with a custom action handler, if needed.","type":"text"}]},{"level":2,"type":"heading","text":"How to open System Settings","anchor":"How-to-open-System-Settings"},{"inlineContent":[{"text":"KeyboardKit has a ","type":"text"},{"inlineContent":[{"text":"URL.keyboardSettings","type":"text"}],"type":"strong"},{"text":" URL extension that can be used to open your app’s keyboard settings in System Settings.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If your keyboard randomly navigates to the System Settings root instead of your app, try adding an empty settings bundle to your app."}]},{"level":2,"text":"How to navigate back to the keyboard from the app","type":"heading","anchor":"How-to-navigate-back-to-the-keyboard-from-the-app"},{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","isActive":true,"type":"reference"},{"type":"text","text":" used to have a "},{"inlineContent":[{"text":"PreviousAppNavigator","type":"text"}],"type":"strong"},{"text":" that could be used to navigate back to the keyboard (in the previously open app) from the main app.","type":"text"}]},{"inlineContent":[{"text":"This was used to e.g. take the user back to the keyboard when dictation finished in the app.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"However, the first implementation, which is also used by apps like Gboard, stopped working in iOS 17, leaving dictation stuck in the main app.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To fix this, KeyboardKit 8 added a new implementation, that used "},{"inlineContent":[{"type":"text","text":"LSApplicationWorkspace"}],"type":"strong"},{"text":" to rather open the bundle ID of the previous app. This fix was however rejected by Apple.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"At the time of writing, there is therefore ","type":"text"},{"inlineContent":[{"type":"text","text":"no way"}],"type":"emphasis"},{"text":" to navigate back to the keyboard from the main app. If you find a way that doesn’t get rejected by Apple, feel free to share it.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"If you want to take a risk at adding the rejected code, here are two implementations that you can add ","type":"text"},{"inlineContent":[{"text":"at your own risk","type":"text"}],"type":"strong"},{"type":"text","text":"."}]},{"inlineContent":[{"text":"Since the lack of back navigation gives a bad user experience, please use the Apple Feedback Assistant to request a native way to achieve this navigation.","type":"text"}],"type":"paragraph"},{"type":"heading","text":"Option 1 - Using LSApplicationWorkspace","anchor":"Option-1-Using-LSApplicationWorkspace","level":3},{"inlineContent":[{"type":"text","text":"The following code uses "},{"inlineContent":[{"text":"LSApplicationWorkspace","type":"text"}],"type":"strong"},{"type":"text","text":" to navigate “forward” to any bundle ID."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["func openPreviousApplication() {","    guard let obj = objc_getClass(\"LSApplicationWorkspace\") as? NSObject else { return false }","    let workspace = obj.perform(Selector((\"defaultWorkspace\")))?.takeUnretainedValue() as? NSObject","    guard let workspace else { return }","    let selector = Selector((\"openApplicationWithBundleID:\"))","    let bundleId = previousApplicationBundleId","    _ = workspace.perform(selector, with: bundleId)","}"]},{"type":"paragraph","inlineContent":[{"text":"The code works in iOS 17, but will most probably be rejected by the App Store review process.","type":"text"}]},{"type":"heading","anchor":"Option-2-Resolving-UIApplicationshared","level":3,"text":"Option 2 - Resolving UIApplication.shared"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This code tries to resolve "},{"type":"strong","inlineContent":[{"type":"text","text":"UIApplication.shared"}]},{"text":" to perform a back navigation.","type":"text"}]},{"code":["func openPreviousApplication() {","    let sysNavIvar = class_getInstanceVariable(UIApplication.self, variableId),","    let action = object_getIvar(UIApplication.shared, sysNavIvar) as? NSObject,","    _ = action.perform(#selector(getter: PrivateSelectors.destinations)).takeUnretainedValue() as? [NSNumber],","}"],"syntax":"swift","type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This code works in iOS 16, but doesn’t work in iOS 17, and will also most probably be rejected."}]}],"kind":"content"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/keyboardkit\/navigation-article"]}],"metadata":{"roleHeading":"Article","title":"Navigation","modules":[{"name":"KeyboardKit"}],"role":"article"},"kind":"article","abstract":[{"type":"text","text":"This article describes the KeyboardKit navigation engine."}],"references":{"doc://KeyboardKit/documentation/KeyboardKit/Callouts-Article":{"url":"\/documentation\/keyboardkit\/callouts-article","abstract":[{"text":"This article describes the KeyboardKit callout engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Callouts-Article","role":"article","kind":"article","title":"Callouts"},"doc://KeyboardKit/documentation/KeyboardKit/AI-Article":{"url":"\/documentation\/keyboardkit\/ai-article","abstract":[{"text":"This article describes the KeyboardKit AI support capabilities.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/AI-Article","role":"article","kind":"article","title":"AI Support"},"doc://KeyboardKit/documentation/KeyboardKit/Settings-Article":{"url":"\/documentation\/keyboardkit\/settings-article","abstract":[{"text":"This article describes the KeyboardKit settings engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Settings-Article","role":"article","kind":"article","title":"Settings"},"doc://KeyboardKit/documentation/KeyboardKit/Text-Routing-Article":{"url":"\/documentation\/keyboardkit\/text-routing-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit text routing engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Text-Routing-Article","role":"article","kind":"article","title":"Text Routing"},"doc://KeyboardKit/documentation/KeyboardKit/Device-Article":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Device-Article","url":"\/documentation\/keyboardkit\/device-article","type":"topic","abstract":[{"type":"text","text":"This article describes various KeyboardKit device utilities."}],"kind":"article","title":"Device Utilities","role":"article"},"doc://KeyboardKit/documentation/KeyboardKit/Localization-Article":{"url":"\/documentation\/keyboardkit\/localization-article","abstract":[{"text":"This article describes the KeyboardKit localization engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Localization-Article","role":"article","kind":"article","title":"Localization"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardAction/url(_:id:)":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction\/url(_:id:)","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"url","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:10Foundation3URLV","text":"URL"},{"text":"?, ","kind":"text"},{"text":"id","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"text":"?)","kind":"text"}],"title":"KeyboardAction.url(_:id:)","url":"\/documentation\/keyboardkit\/keyboardaction\/url(_:id:)","type":"topic","kind":"symbol","abstract":[{"type":"text","text":"Open an url when released, using a custom id for identification."}],"role":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/Extensions-Article":{"url":"\/documentation\/keyboardkit\/extensions-article","abstract":[{"text":"This article describes KeyboardKit native type extensions.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Extensions-Article","role":"article","kind":"article","title":"Extensions"},"doc://KeyboardKit/documentation/KeyboardKit/Layout-Article":{"url":"\/documentation\/keyboardkit\/layout-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit layout engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Layout-Article","role":"article","kind":"article","title":"Layout"},"doc://KeyboardKit/documentation/KeyboardKit/Previews-Article":{"url":"\/documentation\/keyboardkit\/previews-article","abstract":[{"text":"This article describes the KeyboardKit preview engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Previews-Article","role":"article","kind":"article","title":"Previews"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/openUrl(_:)":{"type":"topic","role":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"openUrl","kind":"identifier"},{"kind":"text","text":"("},{"kind":"typeIdentifier","preciseIdentifier":"s:10Foundation3URLV","text":"URL"},{"kind":"text","text":"?)"}],"url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/openurl(_:)","title":"openUrl(_:)","kind":"symbol","abstract":[{"type":"text","text":"Open a certain URL"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/openUrl(_:)"},"doc://KeyboardKit/documentation/KeyboardKit/Colors-Article":{"url":"\/documentation\/keyboardkit\/colors-article","abstract":[{"text":"This article describes the KeyboardKit color engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Colors-Article","role":"article","kind":"article","title":"Colors"},"doc://KeyboardKit/documentation/KeyboardKit/Gestures-Article":{"url":"\/documentation\/keyboardkit\/gestures-article","abstract":[{"text":"This article describes the KeyboardKit gesture engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Gestures-Article","role":"article","kind":"article","title":"Gestures"},"doc://KeyboardKit/documentation/KeyboardKit/Emojis-Article":{"url":"\/documentation\/keyboardkit\/emojis-article","abstract":[{"text":"This article describes the KeyboardKit emoji engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Emojis-Article","role":"article","kind":"article","title":"Emojis"},"doc://KeyboardKit/documentation/KeyboardKit/Actions-Article":{"url":"\/documentation\/keyboardkit\/actions-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit action engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Actions-Article","role":"article","kind":"article","title":"Actions"},"doc://KeyboardKit/documentation/KeyboardKit/State-Article":{"url":"\/documentation\/keyboardkit\/state-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit state engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/State-Article","role":"article","kind":"article","title":"State"},"doc://KeyboardKit/documentation/KeyboardKit/Views":{"url":"\/documentation\/keyboardkit\/views","abstract":[{"text":"This article describes various KeyboardKit views.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Views","role":"article","kind":"article","title":"Views"},"doc://KeyboardKit/documentation/KeyboardKit/Themes-Article":{"url":"\/documentation\/keyboardkit\/themes-article","abstract":[{"text":"This article describes the KeyboardKit theme engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Themes-Article","role":"article","kind":"article","title":"Themes"},"doc://KeyboardKit/documentation/KeyboardKit/Styling-Article":{"url":"\/documentation\/keyboardkit\/styling-article","abstract":[{"text":"This article describes the KeyboardKit styling engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Styling-Article","role":"article","kind":"article","title":"Styling"},"doc://KeyboardKit/documentation/KeyboardKit/Dictation-Article":{"url":"\/documentation\/keyboardkit\/dictation-article","abstract":[{"text":"This article describes the KeyboardKit dictation engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation-Article","role":"article","kind":"article","title":"Dictation [BETA]"},"doc://KeyboardKit/documentation/KeyboardKit/Images-Article":{"url":"\/documentation\/keyboardkit\/images-article","abstract":[{"text":"This article describes the KeyboardKit keyboard image engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Images-Article","role":"article","kind":"article","title":"Images"},"https://github.com/KeyboardKit/KeyboardKitPro":{"type":"link","url":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","title":"KeyboardKit Pro","titleInlineContent":[{"type":"text","text":"KeyboardKit Pro"}]},"doc://KeyboardKit/documentation/KeyboardKit/Buttons-Article":{"url":"\/documentation\/keyboardkit\/buttons-article","abstract":[{"type":"text","text":"This article describes various KeyboardKit buttons."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Buttons-Article","role":"article","kind":"article","title":"Buttons"},"doc://KeyboardKit/documentation/KeyboardKit/External-Keyboards-Article":{"url":"\/documentation\/keyboardkit\/external-keyboards-article","abstract":[{"text":"This article describes the KeyboardKit external keyboard engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/External-Keyboards-Article","role":"article","kind":"article","title":"External Keyboards"},"doc://KeyboardKit/documentation/KeyboardKit/Autocomplete-Article":{"url":"\/documentation\/keyboardkit\/autocomplete-article","abstract":[{"text":"This article describes the KeyboardKit autocomplete engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Autocomplete-Article","role":"article","kind":"article","title":"Autocomplete"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/services":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/services","abstract":[{"type":"text","text":"The default set of keyboard-specific services."}],"role":"symbol","type":"topic","title":"services","kind":"symbol","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/services","fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"services"},{"kind":"text","text":": "},{"text":"Keyboard","kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit0A0V"},{"kind":"text","text":"."},{"kind":"typeIdentifier","preciseIdentifier":"s:11KeyboardKit0A0V0A8ServicesC","text":"KeyboardServices"}]},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardAction":{"url":"\/documentation\/keyboardkit\/keyboardaction","fragments":[{"text":"enum","kind":"keyword"},{"text":" ","kind":"text"},{"text":"KeyboardAction","kind":"identifier"}],"type":"topic","abstract":[{"type":"text","text":"This enum defines keyboard-specific actions that correspond"},{"text":" ","type":"text"},{"text":"to actions that can be found on various keyboards.","type":"text"}],"title":"KeyboardAction","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardAction","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"KeyboardAction"}],"role":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit":{"title":"KeyboardKit","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit","url":"\/documentation\/keyboardkit","role":"collection","abstract":[{"text":"KeyboardKit helps you create custom keyboard extensions with Swift and SwiftUI.","type":"text"}],"kind":"symbol","type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Proxy-Utilities-Article":{"url":"\/documentation\/keyboardkit\/proxy-utilities-article","abstract":[{"text":"This article describes the KeyboardKit proxy engine and its utilities.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Proxy-Utilities-Article","role":"article","kind":"article","title":"Proxy Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Feedback-Article":{"url":"\/documentation\/keyboardkit\/feedback-article","abstract":[{"text":"This article describes the KeyboardKit feedback engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Feedback-Article","role":"article","kind":"article","title":"Feedback"}}}