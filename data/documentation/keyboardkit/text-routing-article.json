{"metadata":{"modules":[{"name":"KeyboardKit"}],"title":"Text Routing","role":"article","roleHeading":"Article"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Text-Routing-Article"},"primaryContentSections":[{"content":[{"level":2,"anchor":"overview","type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"iOS keyboard extensions use the native "},{"inlineContent":[{"text":"UITextDocumentProxy","type":"text"}],"type":"strong"},{"type":"text","text":" to interact with the currently active applicationâ€™s selected text field, e.g. to insert or delete text."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"If you have a text field "},{"inlineContent":[{"type":"text","text":"within"}],"type":"emphasis"},{"text":" your keyboard, you therefore need to find a way to route text to that text field instead of the active application.","type":"text"}]},{"inlineContent":[{"type":"text","text":"KeyboardKit adds ways to make text routing easier. "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController","isActive":true},{"text":" has a custom ","type":"text"},{"isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy","type":"reference"},{"text":" that can be set to route text to any other text field.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro"},{"text":" unlocks even more routing utils, like a ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"KeyboardTextField"}]},{"text":" that automatically register and resign as the main proxy s it receives and loses focus.","type":"text"}],"type":"paragraph"},{"anchor":"How-to-route-text-with-KeyboardKit","type":"heading","text":"How to route text with KeyboardKit","level":2},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"UIInputController"}]},{"text":" has a ","type":"text"},{"inlineContent":[{"type":"text","text":"textDocumentProxy"}],"type":"strong"},{"type":"text","text":", which is how a keyboard extension by default interacts with the currently active application."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"To make text routing easy, "},{"isActive":true,"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController"},{"type":"text","text":" has a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy"},{"type":"text","text":" that can be set to override "},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textDocumentProxy","type":"reference","isActive":true},{"text":" as the main text document proxy.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Setting ","type":"text"},{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy","isActive":true,"type":"reference"},{"type":"text","text":" to a custom proxy will cause any text you type with the keyboard to be sent to that proxy instead of the original proxy."}],"type":"paragraph"},{"inlineContent":[{"text":"Just set ","type":"text"},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy","isActive":true},{"text":" to ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"nil"}]},{"text":" to restore the original proxy and start routing text back to the main application.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"You can always access the original proxy with "},{"type":"reference","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/originalTextDocumentProxy","isActive":true},{"type":"text","text":"."}]},{"type":"heading","text":"ðŸ‘‘ Pro features","level":2,"anchor":"ðŸ‘‘-Pro-features"},{"inlineContent":[{"text":"KeyboardKit Pro unlocks text input components that automatically register and unregister themselves as the main text input proxy when they receive and lose focus:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"KeyboardTextField","type":"text"}]},{"type":"text","text":" wraps a "},{"inlineContent":[{"type":"text","text":"UITextField"}],"type":"strong"},{"text":" and can be used for single-line text inputs.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"KeyboardTextView"}]},{"text":" wraps a ","type":"text"},{"inlineContent":[{"type":"text","text":"UITextView"}],"type":"strong"},{"type":"text","text":" and can be used for multi-line text inputs."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Both views also support SwiftUI "},{"type":"strong","inlineContent":[{"type":"text","text":"FocusState"}]},{"type":"text","text":" and have a "},{"inlineContent":[{"text":"focused","type":"text"}],"type":"strong"},{"type":"text","text":" view modifier that lets you provide a custom done button that slides in when the view is focused."}]},{"syntax":"swift","type":"codeListing","code":["struct CustomKeyboardToolbar: View {","","    unowned var controller: KeyboardInputViewController","","    @State ","    private var text = \"\"","","    @FocusState ","    private var isTextFieldFocused","","    var body: some View {","        if hasFullAccess {","            KeyboardTextField(text: $text, controller: controller) {","                $0.placeholder = \"Type here...\" \/\/ UITextField config","            }","            .focused($isTextFieldFocused) {","                Image(systemName: \"xmark.circle.fill\")","            }","        }","    }","}"]},{"name":"Important","style":"important","content":[{"type":"paragraph","inlineContent":[{"text":"Due to an iOS bug, text inputs in a keyboard extension will crash if Full Access is disabled. To avoid this, this view is automatically disabled if Full Access is disabled.","type":"text"}]}],"type":"aside"}],"kind":"content"}],"abstract":[{"text":"This article describes the KeyboardKit text routing engine.","type":"text"}],"schemaVersion":{"patch":0,"minor":3,"major":0},"sections":[],"kind":"article","seeAlsoSections":[{"identifiers":["doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Actions-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/AI-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Autocomplete-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Buttons-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Callouts-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Colors-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Device-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Emojis-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Extensions-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/External-Keyboards-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Feedback-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Gestures-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Images-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Layout-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Localization-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Navigation-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Previews-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Proxy-Utilities-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Settings-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/State-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Styling-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Themes-Article","doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Views"],"generated":true,"title":"Features"}],"variants":[{"paths":["\/documentation\/keyboardkit\/text-routing-article"],"traits":[{"interfaceLanguage":"swift"}]}],"hierarchy":{"paths":[["doc:\/\/KeyboardKit\/documentation\/KeyboardKit"]]},"references":{"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/textDocumentProxy":{"kind":"symbol","fragments":[{"text":"var","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"textDocumentProxy"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"c:objc(pl)UITextDocumentProxy","text":"UITextDocumentProxy"}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textDocumentProxy","type":"topic","abstract":[{"type":"text","text":"The text document proxy that is currently active."}],"url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/textdocumentproxy","title":"textDocumentProxy","role":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/External-Keyboards-Article":{"url":"\/documentation\/keyboardkit\/external-keyboards-article","abstract":[{"text":"This article describes the KeyboardKit external keyboard engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/External-Keyboards-Article","role":"article","kind":"article","title":"External Keyboards"},"doc://KeyboardKit/documentation/KeyboardKit/State-Article":{"url":"\/documentation\/keyboardkit\/state-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit state engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/State-Article","role":"article","kind":"article","title":"State"},"doc://KeyboardKit/documentation/KeyboardKit/Emojis-Article":{"url":"\/documentation\/keyboardkit\/emojis-article","abstract":[{"text":"This article describes the KeyboardKit emoji engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Emojis-Article","role":"article","kind":"article","title":"Emojis"},"doc://KeyboardKit/documentation/KeyboardKit/AI-Article":{"url":"\/documentation\/keyboardkit\/ai-article","abstract":[{"text":"This article describes the KeyboardKit AI support capabilities.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/AI-Article","role":"article","kind":"article","title":"AI Support"},"doc://KeyboardKit/documentation/KeyboardKit/Buttons-Article":{"url":"\/documentation\/keyboardkit\/buttons-article","abstract":[{"type":"text","text":"This article describes various KeyboardKit buttons."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Buttons-Article","role":"article","kind":"article","title":"Buttons"},"https://github.com/KeyboardKit/KeyboardKitPro":{"url":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","titleInlineContent":[{"type":"text","text":"KeyboardKit Pro"}],"identifier":"https:\/\/github.com\/KeyboardKit\/KeyboardKitPro","type":"link","title":"KeyboardKit Pro"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/textInputProxy":{"type":"topic","role":"symbol","fragments":[{"text":"var","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"textInputProxy"},{"text":": ","kind":"text"},{"preciseIdentifier":"c:@M@KeyboardKit@objc(cs)TextInputProxy","text":"TextInputProxy","kind":"typeIdentifier"},{"text":"?","kind":"text"}],"title":"textInputProxy","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/textinputproxy","kind":"symbol","abstract":[{"type":"text","text":"A custom text proxy to which text can be routed."}],"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/textInputProxy"},"doc://KeyboardKit/documentation/KeyboardKit/Settings-Article":{"url":"\/documentation\/keyboardkit\/settings-article","abstract":[{"text":"This article describes the KeyboardKit settings engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Settings-Article","role":"article","kind":"article","title":"Settings"},"doc://KeyboardKit/documentation/KeyboardKit":{"title":"KeyboardKit","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit","url":"\/documentation\/keyboardkit","role":"collection","abstract":[{"text":"KeyboardKit helps you create custom keyboard extensions with Swift and SwiftUI.","type":"text"}],"kind":"symbol","type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Gestures-Article":{"url":"\/documentation\/keyboardkit\/gestures-article","abstract":[{"text":"This article describes the KeyboardKit gesture engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Gestures-Article","role":"article","kind":"article","title":"Gestures"},"doc://KeyboardKit/documentation/KeyboardKit/Themes-Article":{"url":"\/documentation\/keyboardkit\/themes-article","abstract":[{"text":"This article describes the KeyboardKit theme engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Themes-Article","role":"article","kind":"article","title":"Themes"},"doc://KeyboardKit/documentation/KeyboardKit/Views":{"url":"\/documentation\/keyboardkit\/views","abstract":[{"text":"This article describes various KeyboardKit views.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Views","role":"article","kind":"article","title":"Views"},"doc://KeyboardKit/documentation/KeyboardKit/Feedback-Article":{"url":"\/documentation\/keyboardkit\/feedback-article","abstract":[{"text":"This article describes the KeyboardKit feedback engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Feedback-Article","role":"article","kind":"article","title":"Feedback"},"doc://KeyboardKit/documentation/KeyboardKit/Images-Article":{"url":"\/documentation\/keyboardkit\/images-article","abstract":[{"text":"This article describes the KeyboardKit keyboard image engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Images-Article","role":"article","kind":"article","title":"Images"},"doc://KeyboardKit/documentation/KeyboardKit/Actions-Article":{"url":"\/documentation\/keyboardkit\/actions-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit action engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Actions-Article","role":"article","kind":"article","title":"Actions"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController":{"navigatorTitle":[{"text":"KeyboardInputViewController","kind":"identifier"}],"abstract":[{"text":"This class extends ","type":"text"},{"type":"codeVoice","code":"UIInputViewController"},{"text":" with KeyboardKit","type":"text"},{"type":"text","text":" "},{"type":"text","text":"specific functionality."}],"fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"KeyboardInputViewController","kind":"identifier"}],"url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController","type":"topic","title":"KeyboardInputViewController","kind":"symbol","role":"symbol"},"doc://KeyboardKit/documentation/KeyboardKit/Callouts-Article":{"url":"\/documentation\/keyboardkit\/callouts-article","abstract":[{"text":"This article describes the KeyboardKit callout engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Callouts-Article","role":"article","kind":"article","title":"Callouts"},"doc://KeyboardKit/documentation/KeyboardKit/Dictation-Article":{"url":"\/documentation\/keyboardkit\/dictation-article","abstract":[{"text":"This article describes the KeyboardKit dictation engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Dictation-Article","role":"article","kind":"article","title":"Dictation [BETA]"},"doc://KeyboardKit/documentation/KeyboardKit/Extensions-Article":{"url":"\/documentation\/keyboardkit\/extensions-article","abstract":[{"text":"This article describes KeyboardKit native type extensions.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Extensions-Article","role":"article","kind":"article","title":"Extensions"},"doc://KeyboardKit/documentation/KeyboardKit/Navigation-Article":{"url":"\/documentation\/keyboardkit\/navigation-article","abstract":[{"text":"This article describes the KeyboardKit navigation engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Navigation-Article","role":"article","kind":"article","title":"Navigation"},"doc://KeyboardKit/documentation/KeyboardKit/KeyboardInputViewController/originalTextDocumentProxy":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/KeyboardInputViewController\/originalTextDocumentProxy","role":"symbol","title":"originalTextDocumentProxy","kind":"symbol","url":"\/documentation\/keyboardkit\/keyboardinputviewcontroller\/originaltextdocumentproxy","fragments":[{"text":"var","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"originalTextDocumentProxy"},{"text":": ","kind":"text"},{"preciseIdentifier":"c:objc(pl)UITextDocumentProxy","text":"UITextDocumentProxy","kind":"typeIdentifier"}],"abstract":[{"type":"text","text":"The original text document proxy."}],"type":"topic"},"doc://KeyboardKit/documentation/KeyboardKit/Styling-Article":{"url":"\/documentation\/keyboardkit\/styling-article","abstract":[{"text":"This article describes the KeyboardKit styling engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Styling-Article","role":"article","kind":"article","title":"Styling"},"doc://KeyboardKit/documentation/KeyboardKit/Autocomplete-Article":{"url":"\/documentation\/keyboardkit\/autocomplete-article","abstract":[{"text":"This article describes the KeyboardKit autocomplete engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Autocomplete-Article","role":"article","kind":"article","title":"Autocomplete"},"doc://KeyboardKit/documentation/KeyboardKit/Previews-Article":{"url":"\/documentation\/keyboardkit\/previews-article","abstract":[{"text":"This article describes the KeyboardKit preview engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Previews-Article","role":"article","kind":"article","title":"Previews"},"doc://KeyboardKit/documentation/KeyboardKit/Localization-Article":{"url":"\/documentation\/keyboardkit\/localization-article","abstract":[{"text":"This article describes the KeyboardKit localization engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Localization-Article","role":"article","kind":"article","title":"Localization"},"doc://KeyboardKit/documentation/KeyboardKit/Layout-Article":{"url":"\/documentation\/keyboardkit\/layout-article","abstract":[{"type":"text","text":"This article describes the KeyboardKit layout engine."}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Layout-Article","role":"article","kind":"article","title":"Layout"},"doc://KeyboardKit/documentation/KeyboardKit/Proxy-Utilities-Article":{"url":"\/documentation\/keyboardkit\/proxy-utilities-article","abstract":[{"text":"This article describes the KeyboardKit proxy engine and its utilities.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Proxy-Utilities-Article","role":"article","kind":"article","title":"Proxy Utilities"},"doc://KeyboardKit/documentation/KeyboardKit/Colors-Article":{"url":"\/documentation\/keyboardkit\/colors-article","abstract":[{"text":"This article describes the KeyboardKit color engine.","type":"text"}],"type":"topic","identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Colors-Article","role":"article","kind":"article","title":"Colors"},"doc://KeyboardKit/documentation/KeyboardKit/Device-Article":{"identifier":"doc:\/\/KeyboardKit\/documentation\/KeyboardKit\/Device-Article","url":"\/documentation\/keyboardkit\/device-article","type":"topic","abstract":[{"type":"text","text":"This article describes various KeyboardKit device utilities."}],"kind":"article","title":"Device Utilities","role":"article"}}}